url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
rbind(list, dates)
rbind(list, sites)
}
list <- list()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
rbind(list, dates)
rbind(list, sites)
}
View(list)
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
rbind(list, dates, sites)
}
list <- list()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
rbind(list, dates, sites)
}
list <- list()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
list() <- rbind(list, dates, sites)
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
list <- rbind(list, dates, sites)
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
list() <- rbind(list, dates, sites)
}
View(list)
list <- list()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
list() <- rbind(list, dates, sites)
}
list <- list()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
list <- rbind(list, dates, sites)
}
View(list)
df <- data_frame()
df <- data_frame()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- dates
df[,1] <- sites
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- dates
df[,2] <- sites
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[[1]] <- dates
df[[2]] <- sites
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
rbind(df, dates)
rbind(df, sites)
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df, dates)
df[,2] <- rbind(df, sites)
}
df <- data_frame()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df, dates)
df[,2] <- rbind(df, sites)
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df[,1], dates)
df[,2] <- rbind(df[,2], sites)
}
df <- data_frame()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df[,1], dates)
df[,2] <- rbind(df[,2], sites)
}
View(df)
df <- data.frame()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df[,1], dates)
df[,2] <- rbind(df[,2], sites)
}
df <- data_frame()
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df[,1], dates)
df[,2] <- rbind(df[,2], sites)
}
df <- data.frame()
df <- data.frame(colnames("date", "site"))
df <- data.frame(colnames = c("date", "site"))
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df[,1], dates)
df[,2] <- rbind(df[,2], sites)
}
View(df)
df <- data.frame(colnames = c("date", "site"))
View(df)
df <- data.frame(col = c("date", "site"))
View(df)
df <- data.frame(ncol = 2)
var_names <- c("date", "site")
colnames(df) <- var_names
View(df)
df <- data.frame(ncol = 2)
var_names <- c("date", "site")
colnames(df) <- var_names
df <- data.frame(matrix(ncol = 2))
var_names <- c("date", "site")
colnames(df) <- var_names
View(df)
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df[,1], dates)
df[,2] <- rbind(df[,2], sites)
}
for (i in 1:2) {
url <- paste0("https://cwbchicago.com/page/",i)
url <- read_html(url)
main_sqr <- html_node(url, "#main-content")
article <- html_nodes(main_sqr, "article")
dates_spe <- html_nodes(article, ".entry-meta-date")
dates <- html_text(dates_spe, "href")
site_spe <- html_nodes(article, ".mh-excerpt-more")
sites <- html_attr(site_spe, "href")
df[,1] <- rbind(df[,1], dates)
df[,2] <- rbind(df[,2], sites)
}
library(tidyverse)
library(stargazer)
crimes <- read_csv(file = "Crimes_tidy.csv")
crimes <- crimes %>%
mutate(month = as.factor(month(crimes$Date)),
year = as.factor(year(crimes$Date)),
ward = as.factor(crimes$Ward),
arrest = crimes$Arrest)
crimes_sub <- crimes %>%
select(month, guns, arrest, ward) %>%
group_by(month, guns, arrest, ward) %>%
summarise(cases = n())
crimes_ols <- lm(cases ~ ., data = crimes_sub)
stargazer(crimes_ols, type = "html", out = "fit_lm.html")
library(tidyverse)
library(stargazer)
crimes <- read_csv(file = "Crimes_tidy.csv")
crimes <- crimes %>%
mutate(month = as.factor(month(crimes$Date)),
year = as.factor(year(crimes$Date)),
ward = as.factor(crimes$Ward),
arrest = crimes$Arrest)
crimes_sub <- crimes %>%
select(month, guns, arrest, ward) %>%
group_by(month, guns, arrest, ward) %>%
summarise(cases = n())
crimes_ols <- lm(cases ~ ., data = crimes_sub)
stargazer(crimes_ols, type = "html", out = "fit_lm.html")
library(tidyverse)
library(stargazer)
crimes <- read_csv(file = "Crimes_tidy.csv")
crimes <- crimes %>%
mutate(month = as.factor(month(crimes$Date)),
year = as.factor(year(crimes$Date)),
ward = as.factor(crimes$Ward),
arrest = crimes$Arrest)
getwd()
setwd(C:/Users/guill/OneDrive/Documents/Data and Programming II/final project)
setwd("C:/Users/guill/OneDrive/Documents/Data and Programming II/final project")
getwd
getwd()
library(tidyverse)
library(stargazer)
crimes <- read_csv(file = "Crimes_tidy.csv")
crimes <- crimes %>%
mutate(month = as.factor(month(crimes$Date)),
year = as.factor(year(crimes$Date)),
ward = as.factor(crimes$Ward),
arrest = crimes$Arrest)
crimes_sub <- crimes %>%
select(month, guns, arrest, ward) %>%
group_by(month, guns, arrest, ward) %>%
summarise(cases = n())
crimes_ols <- lm(cases ~ ., data = crimes_sub)
stargazer(crimes_ols, type = "html", out = "fit_lm.html")
library(tidyverse)
library(stargazer)
crimes <- read_csv(file = "Crimes_tidy.csv")
crimes <- crimes %>%
mutate(month = as.factor(month(crimes$Date)),
year = as.factor(year(crimes$Date)),
ward = as.factor(crimes$Ward),
arrest = crimes$Arrest)
library(lubridate)
library(tidyverse)
library(stargazer)
crimes <- read_csv(file = "Crimes_tidy.csv")
crimes <- crimes %>%
mutate(month = as.factor(month(crimes$Date)),
year = as.factor(year(crimes$Date)),
ward = as.factor(crimes$Ward),
arrest = crimes$Arrest)
crimes_sub <- crimes %>%
select(month, guns, arrest, ward) %>%
group_by(month, guns, arrest, ward) %>%
summarise(cases = n())
crimes_ols <- lm(cases ~ ., data = crimes_sub)
stargazer(crimes_ols, type = "html", out = "fit_lm.html")
library(tidyverse)
library(sf)
# Subset
crimes <- read_csv(file = "Crimes_-_2001_to_Present.csv")
crimes_2019 <- crimes %>%
filter(Year == 2019)
crimes_2019$Date <- as.POSIXct(strptime(crimes_2019$Date, format = "%m/%d/%Y"))
crimes_summer2019 <- crimes_2019 %>%
filter(Date >= "2019/06/01",
Date <= "2019/09/30")
write_csv(crimes_summer2019, "Crimes_summer2019_.csv")
library(tidyverse)
library(sf)
# Subset
crimes <- read_csv(file = "Crimes_-_2001_to_Present.csv")
crimes_2019 <- crimes %>%
filter(Year == 2019)
crimes_2019$Date <- as.POSIXct(strptime(crimes_2019$Date, format = "%m/%d/%Y"))
crimes_summer2019 <- crimes_2019 %>%
filter(Date >= "2019/06/01",
Date <= "2019/09/30")
write_csv(crimes_summer2019, "Crimes_summer2019_.csv")
crimes <- read_csv(file = "Crimes_summer2019_.csv")
colSums(is.na(crimes))
crimes_drop_na <- crimes %>%
select(-`Updated On`) %>%
drop_na(`X Coordinate`, `Y Coordinate`, Ward)
crimes_gundummy <- crimes_drop_na %>%
mutate(guns = str_detect(crimes_drop_na$Description, "HANDGUN|GUN|FIREARM|RIFLE"))
write_csv(crimes_gundummy, "Crimes_tidy.csv")
# Tidy
crimes <- read_csv(file = "Crimes_summer2019_.csv")
colSums(is.na(crimes))
crimes_drop_na <- crimes %>%
select(-`Updated On`) %>%
drop_na(`X Coordinate`, `Y Coordinate`, Ward)
crimes <- read_csv(file = "Crimes_-_2001_to_Present.csv")
crimes_2019 <- crimes %>%
filter(Year == 2019)
crimes_2019$Date <- as.POSIXct(strptime(crimes_2019$Date, format = "%m/%d/%Y"))
crimes_summer2019 <- crimes_2019 %>%
filter(Date >= "2019/06/01",
Date <= "2019/09/30")
write_csv(crimes_summer2019, "Crimes_summer2019_.csv")
# Tidy
crimes <- read_csv(file = "Crimes_summer2019_.csv")
colSums(is.na(crimes))
crimes_drop_na <- crimes %>%
select(-`Updated On`) %>%
drop_na(`X Coordinate`, `Y Coordinate`, Ward)
crimes_gundummy <- crimes_drop_na %>%
mutate(guns = str_detect(crimes_drop_na$Description, "HANDGUN|GUN|FIREARM|RIFLE"))
write_csv(crimes_gundummy, "Crimes_tidy.csv")
# Time series
crimes_ts <- crimes_gundummy %>%
group_by(Date, guns) %>%
summarise(n = n())
ggplot(crimes_ts, aes(Date,n, color = guns)) +
geom_line()
adf.test(crimes_ts$n, nlag = NULL, output = TRUE)
acf(crimes_ts$n)
crimes_ts_guns <- crimes_gundummy %>%
filter(guns == TRUE) %>%
group_by(Date, `Primary Type`) %>%
summarise(n = n())
ggplot(crimes_ts_guns, aes(Date,n, color = `Primary Type`)) +
geom_line() +
labs(title = "Type of Crimes Within Guns") +
theme(plot.title = element_text(hjust = 0.5)) +
theme_bw()
ggsave(filename = "Time Series - Crimes.png",
plot = plot_nrc,
bg = "white")
ts_crimes <- ggplot(crimes_ts, aes(Date,n, color = guns)) +
geom_line()
ggsave(filename = "Time Series - Crimes.png",
plot = ts_crimes,
bg = "white")
adf.test(crimes_ts$n, nlag = NULL, output = TRUE)
acf(crimes_ts$n)
acf_crimes <- acf(crimes_ts$n)
adf.test(crimes_ts$n, nlag = NULL, output = TRUE)
acf_crimes <- acf(crimes_ts$n)
ggsave(filename = "ACF test - Crimes.png",
plot = acf_crimes,
bg = "white")
acf_crimes <- acf(crimes_ts$n)
stargazer(acf_crimes, type = "html", out = "fit_lm.html")
ggsave(filename = "ACF test - Crimes.png",
plot = acf_crimes,
bg = "white")
acf(crimes_ts$n)
crimes_ts_guns <- crimes_gundummy %>%
filter(guns == TRUE) %>%
group_by(Date, `Primary Type`) %>%
summarise(n = n())
ggplot(crimes_ts_guns, aes(Date,n, color = `Primary Type`)) +
geom_line() +
labs(title = "Type of Crimes Within Guns") +
theme(plot.title = element_text(hjust = 0.5)) +
theme_bw()
podcast_url <- "https://news.uchicago.edu/confronting-gun-violence-data-jens-ludwig"
html <- read_html(podcast_url)
library(tidyverse)
library(tidytext)
library(rvest)
library(udpipe)
library(nametagger)
library(SnowballC)
library(stringr)
library(anytime)
library(sf)
library(spData)
library(scales)
library(RColorBrewer)
library(tidycensus)
library(tmap)
library(ggrepel)
html <- read_html(podcast_url)
# we inspect element in html source code to identify #left-area for text
article_podcastnotes <- html_node(html, "#app")
transcript_parts <- html_nodes(article_podcastnotes, "p")
transcript_list <- html_text(transcript_parts)
text <- paste(transcript_list, collapse = "")
sentiment_nrc <- get_sentiments("nrc")
podcast_text_nrc <- text %>%
left_join(get_sentiments("nrc"), by = c("word_tokens" = "word"))
View(sentiment_nrc)
text_df <- tibble(text = text)
word_tokens_df <- unnest_tokens(text_df, word_tokens,  text, token = "words")
no_sw_df <- anti_join(word_tokens_df, stop_words,
by = c("word_tokens" = "word"))
podcast_text_nrc <- text_df %>%
left_join(get_sentiments("nrc"), by = c("word_tokens" = "word"))
View(text_df)
View(word_tokens_df)
podcast_text_nrc <- no_sw_df %>%
left_join(get_sentiments("nrc"), by = c("word_tokens" = "word"))
podcast_plot_nrc <- ggplot(data = filter(podcast_text_nrc, !is.na(sentiment))) +
geom_histogram(aes(sentiment), stat = "count") +
scale_x_discrete(guide = guide_axis(angle = 45)) +
labs(title = "Sentiment Analysis - Big Brains Podcast Ep 82",
subtitle = "NRC Sentiment") +
theme_minimal()
